---
import { Image } from 'astro:assets';
import SocialLinks from './SocialLinks.astro';
import { getRoleName } from '../../lib/utils';
import { getImageShapeClass, isCircularShape } from '../../lib/imageShape';

interface Props {
  id: string;
  name: string;
  role: string;
  title?: string;
  photo?: ImageMetadata;
  email?: string;
  socials?: Record<string, string | undefined>;
  startDate?: Date;
  showDate?: boolean;
}

const { id, name, role, title, photo, email, socials, startDate, showDate = false } = Astro.props;
const displayTitle = title || getRoleName(role);
const shapeClass = getImageShapeClass();
const circular = isCircularShape();
---

<a href={`/people/${id}`} class="block text-center group">
  <!-- Photo -->
  <div class:list={["mx-auto mb-3 overflow-hidden bg-surface-100 dark:bg-dm-alt", shapeClass, circular ? "w-[140px] h-[140px]" : "w-[140px] h-[170px]"]}>
    {photo ? (
      <Image
        src={photo}
        alt={name}
        width={140}
        height={170}
        class="w-full h-full object-cover"
      />
    ) : (
      <div class="w-full h-full flex items-center justify-center text-2xl font-light text-surface-400 dark:text-dm-faint font-serif">
        {name.split(' ').map(n => n[0]).join('')}
      </div>
    )}
  </div>

  <!-- Name & title -->
  <h3 class="font-medium text-sm text-surface-900 dark:text-dm-heading group-hover:text-primary-600 dark:group-hover:text-accent-400 transition-colors">
    {name}
  </h3>
  <p class="text-xs text-surface-500 dark:text-dm-muted mt-0.5">
    {displayTitle}
  </p>
  {showDate && startDate && (
    <p class="text-xs text-surface-400 dark:text-dm-faint mt-0.5">
      {startDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
    </p>
  )}
</a>
