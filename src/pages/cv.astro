---
import PageLayout from '../layouts/PageLayout.astro';
import PublicationEntry from '../components/astro/PublicationEntry.astro';
import { getCollection } from 'astro:content';
import { getSiteConfig } from '../lib/config';

const config = getSiteConfig();
const publications = (await getCollection('publications'))
  .sort((a, b) => b.data.year - a.data.year);
---

<PageLayout title="CV" description={`Curriculum Vitae of ${config.author}`}>
  <div class="flex items-start justify-between gap-4 mb-6">
    <div>
      <h1 class="text-2xl sm:text-3xl font-serif font-normal text-surface-900 dark:text-[#e6edf3] mb-1">{config.author}</h1>
      <p class="text-sm text-surface-500 dark:text-[#8b949e]">{config.department}, {config.university}</p>
    </div>
    <a
      href="#"
      class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm rounded border border-surface-200 dark:border-[#21262d] text-primary-600 dark:text-accent-400 hover:bg-surface-50 dark:hover:bg-[#161b22] transition-colors shrink-0"
    >
      <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
      Download PDF
    </a>
  </div>

  <!-- Education -->
  <section class="mb-8">
    <h2 class="text-lg font-serif font-normal text-surface-900 dark:text-[#e6edf3] pb-2 border-b border-surface-200 dark:border-[#21262d] mb-3">
      Education
    </h2>
    <div class="space-y-3">
      <div class="flex justify-between items-baseline">
        <div>
          <h3 class="text-sm font-medium text-surface-900 dark:text-[#e6edf3]">Ph.D. in Computer Science</h3>
          <p class="text-sm text-surface-500 dark:text-[#8b949e]">University of Example</p>
        </div>
        <span class="text-xs text-surface-400 dark:text-[#484f58] shrink-0 ms-4">2010 - 2015</span>
      </div>
      <div class="flex justify-between items-baseline">
        <div>
          <h3 class="text-sm font-medium text-surface-900 dark:text-[#e6edf3]">M.S. in Computer Science</h3>
          <p class="text-sm text-surface-500 dark:text-[#8b949e]">University of Example</p>
        </div>
        <span class="text-xs text-surface-400 dark:text-[#484f58] shrink-0 ms-4">2008 - 2010</span>
      </div>
    </div>
  </section>

  <!-- Experience -->
  <section class="mb-8">
    <h2 class="text-lg font-serif font-normal text-surface-900 dark:text-[#e6edf3] pb-2 border-b border-surface-200 dark:border-[#21262d] mb-3">
      Experience
    </h2>
    <div class="space-y-3">
      <div class="flex justify-between items-baseline">
        <div>
          <h3 class="text-sm font-medium text-surface-900 dark:text-[#e6edf3]">Associate Professor</h3>
          <p class="text-sm text-surface-500 dark:text-[#8b949e]">{config.university}</p>
        </div>
        <span class="text-xs text-surface-400 dark:text-[#484f58] shrink-0 ms-4">2020 - Present</span>
      </div>
      <div class="flex justify-between items-baseline">
        <div>
          <h3 class="text-sm font-medium text-surface-900 dark:text-[#e6edf3]">Assistant Professor</h3>
          <p class="text-sm text-surface-500 dark:text-[#8b949e]">Previous University</p>
        </div>
        <span class="text-xs text-surface-400 dark:text-[#484f58] shrink-0 ms-4">2015 - 2020</span>
      </div>
    </div>
  </section>

  <!-- Selected Publications -->
  <section class="mb-8">
    <h2 class="text-lg font-serif font-normal text-surface-900 dark:text-[#e6edf3] pb-2 border-b border-surface-200 dark:border-[#21262d] mb-3">
      Selected Publications
      <a href="/publications" class="float-end text-xs font-sans text-primary-600 dark:text-accent-400 hover:underline">View all &rarr;</a>
    </h2>
    <div class="space-y-3">
      {publications.slice(0, 5).map(pub => (
        <PublicationEntry
          title={pub.data.title}
          authors={pub.data.authors}
          venue={pub.data.venue}
          year={pub.data.year}
          doi={pub.data.doi}
          url={pub.data.url}
          type={pub.data.type}
          highlightAuthors={[config.author]}
        />
      ))}
    </div>
  </section>

  <!-- Awards -->
  <section>
    <h2 class="text-lg font-serif font-normal text-surface-900 dark:text-[#e6edf3] pb-2 border-b border-surface-200 dark:border-[#21262d] mb-3">
      Awards & Honors
    </h2>
    <div class="space-y-2">
      {[
        { award: 'Best Paper Award, ACL 2023', year: '2023' },
        { award: 'NSF CAREER Award', year: '2022' },
        { award: 'Outstanding Dissertation Award', year: '2016' },
      ].map(item => (
        <div class="flex justify-between items-center text-sm">
          <span class="text-surface-700 dark:text-[#c9d1d9]">{item.award}</span>
          <span class="text-xs text-surface-400 dark:text-[#484f58]">{item.year}</span>
        </div>
      ))}
    </div>
  </section>
</PageLayout>
